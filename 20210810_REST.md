# REST

REST API, RESTful API라는 단어는 알고 있었지만 정확하게 뭔지는 몰랐었는데 이번 기회에 알아보려고 한다.

일반적으로 앱이나 웹에서 작동하는 App을 개발할 때는 Http, Https 프로토콜을 사용해서 API를 만드는데

이 API의 정의가 얼마나 직관적이고 명확하냐에 따라 프로젝트의 복잡도가 크게 낮아진다고 하니.. 매우 중요해보인다.

## REST는 무슨 뜻?

**REST** 는 REpresentational State Transfer의 약자인데 중요한건 역시 Representational State.

유연하게 번역하면 **표현된 상태**라고 할 수 있는데 여기서 상태는 서버가 가지고 있는 리소스의 상태를 말한다.

많은 사람들이 **표현된 상태**에 대해 이해를 어려워하는데

이는 클라이언트와 서버가 API통신을 통해 주고받고 있는 것들이 리소스 그 자체라고 생각하기 때문이다.

그런데 조금만 생각해보면 우리가 통신을 통해 리소스를 직접 주고받지 않다는 사실을 알 수 있다.

## 리소스가 아니라고?

우리가 API를 통해 주고받는 리소스는 어떤 문서일 수도 있고 이미지 또는 JSON 일 수도 있다.

근데! 사실 우리는 리소스를 직접 주고받는게 아니다.

아래 코드로 한번 말아보자

```http
GET https://iamserver.com/api/users/2
Host: iamserver.com
Accept: application/json
```
클라이언트가 서버에게 특정 유저의 정보를 받아오는 API 엔드포인트를 통해 요청을 보냈다.

그러면 서버에서는

```http
HTTP/1.1 200 OK
Content-Length: 45
Content-Type: application/json

{
  id: 2,
  name: 'Evan',
  org: 'Viva Republica',
}
```
이런 응답을 보내준다.

서버가 보내준 응답에는 2번 유저의 데이터가 있는데.

일반적으로 이런 상황을 `/api/users/2`라는 엔드포인트를 통해서 2번 유저 데이터 리소스를 받아왔다고 표현한다.

그런데 지금 서버에서 보내준 저 JSON데이터가 리소스 자체일까?

### **아니다!**

서버에서 보내준 JSON은 리소스 원본이 아니라 데이터베이스에 저장된 2번 유저의 데이터 리소스를 표현한 것일 뿐이다.

서버는 클라이언트의 요청을 받고 2번 유저의 정보를 데이터베이스에서 조회한 후 요청의 헤더에 담겨있던 `application/json`형식으로 표현해 응답해준 것이다.

곰곰히 생각해보면 당연한 이야기인데 서버가 접근하는 지니짜 리소스 원본은 DB에 있는 로우 혹은 파일에 작성된 데이터이다.

물론 서버의 Local에서 리소스를 JSON으로 저장하고 있을 수도 있지만 서버가 보내준 JSON이 원본 리소스가 아님은 분명하다.

서버가 보내준 JSON은 DB에 저장되어있는 원본 데이터 리소스의 **현재상태를 표현**한 것이다.

## 리소스를 표현한 상태?

앞에서 말했듯 REST가 말하는 Representation State라는 단어는 원본 리소스를 표현한 상태라는 것을 의미한다.

원본은 DB에 저장된 하나의 로우로써 존재하는데 그걸 클라쪽에 그대로 넘겨줄 수 없으니까 읽어와서 **적당한 상태**로 표현해주는 것이다.

적당한 상태에 대한 힌트는 HTTP 요청 헤더나 응답 헤더에 나와있다.

```html
GET https://iamserver.com/api/users/2
Host: iamserver.com
Accept: application/json
<!-- [출처]https://evan-moon.github.io/2020/04/07/about-restful-api/-->
```

위에서 예시로 들었던 상황에서 클라는 서버에게 2번 유저의 리소르르 요청하면서 요청 헤더의 `Accept`라는 키에 `application/json`이라는 값을 담아서 보냈다.

클라이언트가 서버에게

### **2번 유저의 상태를 JSON으로 표현해줘** 

라는 요청을 보낸 것이다.

만약 클라가 application/json 말고 application/xml을 담아서 보냈고 서버가 XML포맷의 표현을 지원하도록 되있다면 2번 유저의 리소스는 XML로 표현되어서 보내졌을 것이다.

서버는 응답 헤더에 Content-Type이나 Content-Language 같은  키를 사용해 리소스가 어떤 식으로 표현된 상태인지 클라에게 알려주고, 클라 또한 이 정보를 읽은 후 각 컨텐츠 타입에 맞게 정보를 파싱한다.

클라는 2번 유저의 리소스를 받은 것이 아니다. JSON으로 표현된 2번 유저 리소스의 현재 상태를 받은 것이다.

이처럼 REST는 클라이언트와 서버가 리소스의 타입이나 원하는 언어 등을 사용하여 자원을 자유롭고 명확하게 표현할 수 있는 것에 집중한다.


